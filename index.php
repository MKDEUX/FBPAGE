<?php 

include 'functions.php';
include'distance.functions.php'; 

if (isset($_GET['period'])) {
  $period = $_GET['period'];
} else {
  $period = 'today';
}


?>

<!doctype html>
<html lang="en">
  <head> 
   
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap CSS -->

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
      <!--

    xx 1) Bandeau de logo noir
    xx 2) Background de la page comme sur let emplate
    xx 3) Faire un petit titre en mode "Bienvenue sur votre tableau de bord
    xx 4) Faire des gros carrés
    xx 5) Chosiri des couleurs qui te plaisent
  
    xx 6) Intégrer des textes et eds chiffres factices dans tes carrés
    xx 7) Remplacer les couleurs de fonds par des dégradés
      
    xx 8) Padding dans les carrés pour arérer le texte (ex: http://preview.themeforest.net/item/emilus-react-admin-template/full_screen_preview/28400277?_ga=2.133779276.312744981.1621596456-420671464.1621425215)

    xx 9) Donner une height à tous tes blocs pour harmoniser leur taille et leur donner un peu plus de volume
    xx 10) Mieux aligner et aérer le texte de bienvenue.
    xx 11) Ajouter un dropdown menu pour sélectionner la plage de date (s'inspirer de https://mannatthemes.com/dastone/default/index.html#)
    Objectif perso: 
    -fixer le filtre( le filtre doit prendre le nom de l'option sélectionné)
    -réaranger les carte pour le responsive design 

      ??) Ajouter une image dans les blocs

    -->

    
      <style>
       .logo {
          margin-top: 30px;
          margin-bottom: 35px;
          width: 138px;
          height: 57px;
        }

        .fond-logo {
          background-color: #000000
        }

        .espace-card {
          margin-right: 50px
        }

        .left-orange-card {
          background:#0984e3;
          transition: 1s;
        }

        .middle-orange-card {
         background:#0984e3;
         transition: 1s;
        }

        .right-orange-card {
         background:#0984e3;
         transition: 1s;
        }

        .left-green-card {
          background:#0984e3;
          transition: 1s;
         
        }

        .mid-green-card {
          background:#0984e3;
          transition: 1s;
        }

        .right-green-card {
          background:#0984e3;
          transition: 1s;
        }

        .yellow-card {
          background:#0984e3;
          transition: 1s;
        }

        .left-purple-card {
         background:#0984e3;
         transition: 1s;
        }

        .mid-purple-card {
        background:#0984e3;
        transition: 1s;
        }

        .right-purple-card {
       background:#0984e3;
       transition: 1s;
        }

        .camion {
          border: 0;
          width: 40%;
          padding-right:60px;
          padding-left:60px;  
        }

        .titre {
          margin-left: 85px;
        }

        .card {
          height: 200px
        }

        .fadeIn {
          -webkit-animation-name: fadeIn;
          animation-name: fadeIn;
          -webkit-animation-duration: 1s;
          animation-duration: 1s;
          -webkit-animation-fill-mode: both;
          animation-fill-mode: both;
        }

        @-webkit-keyframes fadeIn {
          0% {
            opacity: 0;
          }
          100% {
            opacity: 1;
          }
        }

        @keyframes fadeIn {
          0% {
            opacity: 0;
          }
          100% {
            opacity: 1;
          }
        }

        .slideInLeft {
          -webkit-animation-name: slideInLeft;
          animation-name: slideInLeft;
          -webkit-animation-duration: 1s;
          animation-duration: 1s;
          -webkit-animation-fill-mode: both;
          animation-fill-mode: both;
        }

        @-webkit-keyframes slideInLeft {
          0% {
            -webkit-transform: translateX(-100%);
            transform: translateX(-100%);
            visibility: visible;
          }
          100% {
            -webkit-transform: translateX(0);
            transform: translateX(0);
          }
        }

        @keyframes slideInLeft {
          0% {
            -webkit-transform: translateX(-100%);
            transform: translateX(-100%);
            visibility: visible;
          }
          100% {
            -webkit-transform: translateX(0);
            transform: translateX(0);
          }
        }
        
        .margin-dropdown
        {
          right:15px;

        }

        .dropdown {
           
            z-index: 9999;
        }

        .icon-camion {
          width:100%;
          height:200px;
          position:absolute;
          top:0px;
          left:0px;
          background:url(https://image.flaticon.com/icons/png/512/232/232561.png);
          background-size:200px 200px;
          background-repeat:no-repeat;
          background-position:bottom -5px right 5px;
           z-index: -9999;
           display:none;
        }

        .icon-livre {
          width:100%;
          height:200px;
          position:absolute;
          top:0px;
          left:0px;
          background:url(https://image.flaticon.com/icons/png/512/21/21923.png);
          background-size:200px 150px;
          background-repeat:no-repeat;
          background-position:bottom 10px right -25px;
           z-index: -9999;
           display:none;
        }

         .icon-poids {
          width:100%;
          height:200px;
          position:absolute;
          top:0px;
          left:0px;
          background:url(https://image.flaticon.com/icons/png/512/242/242578.png);
          background-size:300px 300px;
          background-repeat:no-repeat;
          background-position:bottom -70px right -10px;
           z-index: -9999;
           display:none;
        }

         .icon-avion {
          width:100%;
          height:200px;
          position:absolute;
          top:0px;
          left:0px;
          background:url(https://image.flaticon.com/icons/png/512/198/198215.png);
          background-size:170px 170px;
          background-repeat:no-repeat;
          background-position:bottom 10px right 10px;*
           z-index: -9999;
           display:none;
        }

         .icon-genre {
          width:100%;
          height:200px;
          position:absolute;
          top:0px;
          left:0px;
          background:url(https://image.flaticon.com/icons/png/512/45/45947.png);
          background-size:170px 170px;
          background-repeat:no-repeat;
          background-position:bottom 10px right 10px;
          z-index: -9999;
          display:none;
        }

         .icon-arbre{
          width:100%;
          height:200px;
          position:absolute;
          top:0px;
          left:0px;
          background:url(http://www.clker.com/cliparts/L/4/P/V/I/w/black-tree-md.png);
          background-size:170px 170px;
          background-repeat:no-repeat;
          background-position:bottom 10px right 10px;
           z-index: -9999;
           display:none;
        }

         .icon-terre{
          width:100%;
          height:200px;
          position:absolute;
          top:0px;
          left:0px;
          background:url(https://image.flaticon.com/icons/png/512/823/823975.png);
          background-size:170px 170px;
          background-repeat:no-repeat;
          background-position:bottom 10px right 10px;
           z-index: -9999;
           display:none;
        }

          .icon-user{
          width:100%;
          height:200px;
          position:absolute;
          top:0px;
          left:0px;
          background:url(https://image.flaticon.com/icons/png/512/702/702983.png);
          background-size:170px 170px;
          background-repeat:no-repeat;
          background-position:bottom 10px right 10px;
           z-index: -9999;
           display:none;
        }

        .icon-carton{
          width:100%;
          height:200px;
          position:absolute;
          top:0px;
          left:0px;
          background:url(https://img.icons8.com/ios/452/open-parcel.png);
          background-size:170px 170px;
          background-repeat:no-repeat;
          background-position:bottom 10px right 10px;
           z-index: -9999;
           display:none;

        }
         .icon-ville{
          width:100%;
          height:200px;
          position:absolute;
          top:0px;
          left:0px;
          background:url(https://img.icons8.com/ios-filled/452/city.png);
          background-size:170px 170px;
          background-repeat:no-repeat;
          background-position:bottom 10px right 10px;
           z-index: -9999;
           display:none;
        }
        

        .colorpicker-red {
           border: 8px solid #d63031;
           width: 20px;
           height: 20px;
           background-color: #d63031;
           display: inline-block;
           border-radius: 100%;
           cursor: pointer;
            
          /*
          la taille du div (width et height) : figée;
          definir background
          mettre des bordures arrondies (à 100%)
           */
        }

          .colorpicker-blue {
           border: 8px solid #0984e3;
           width: 20px;
           height: 20px;
           background-color: #0984e3;
           display: inline-block;
           border-radius: 100%;
           cursor: pointer;
            
          /*
          la taille du div (width et height) : figée;
          definir background
          mettre des bordures arrondies (à 100%)
           */
        }

        .colorpicker-green {
           border: 8px solid #00b894;
           width: 20px;
           height: 20px;
           background-color: #00b894;
           display: inline-block;
           border-radius: 100%;
           cursor: pointer;
            
          /**
           * doubler la taille
           * mettre des bordyres arrondies
           * changer le cursuer quand on survolle le bouton (css)
           * trouver des jolies couleur, pas des trucs hardcore type"yellow","red"
           */
        }
      .drop-blue
      {
        border-color: #0984e3;
        color:#0984e3;
        transition: 1s
      }




      </style>
      <title>Hello, world!</title>
    </head>

   <body>
      <div class="container-fluid  fond-logo fadeIn ">
        <div class="row">
          <!-- <div class="text-center"> -->
          <div  style="text-align:center;">
            <img src="https://brocolis.fantasticbook.co/assets/custom/img/logo2021-white.svg" class="logo  " alt="Responsive image">
          </div>
        </div>
      </div>

      <div class="container-fluid">

        <div class="row display-5">
          <div class="col-12">
          <p class="mt-5 ms-5 fadeIn slideInLeft">Bienvenue sur votre tableau de bord</p>
          <div class="dropdown  fadeIn text-end mx-5 margin-dropdown ">
            
            <div class="text-right" style="height:20px;">
              <span id="colorpicker-blue"  class="colorpicker-blue">&nbsp;</span>
              <span id="colorpicker-red"  class="colorpicker-red">&nbsp;</span>
              <span id="colorpicker-green"  class="colorpicker-green">&nbsp;</span>
            </div>

            <button class="btn btn-secondary dropdown-toggle text bg-white drop-blue " href="#" role="button" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-expanded="false">
              <?php
              switch($period) 
                {
                  case "today":
                      echo "Aujourd'hui";
                      break;
                  case "thisweek":
                      echo "Cette semaine";
                      break;
                  case "thismonth":
                      echo "Ce mois";
                      break;
                  case "lastmonth":
                      echo "Le mois précédent";
                      break;
                  case "thisyear":
                      echo "Cette année";
                      break;
                }
               ?>
            </button>


             <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">

              <!-- Créer les bons liens avec les paramètres d'URL -->
              <!--  -->
              <li><a class="dropdown-item" href="index.php?period=today">Aujourd'hui</a></li>
              <li><a class="dropdown-item" href="index.php?period=thisweek">Cette semaine</a></li>
              <li><a class="dropdown-item" href="index.php?period=thismonth">Ce mois</a></li>
              <li><a class="dropdown-item" href="index.php?period=lastmonth">Le mois précédent</a></li>
              <li><a class="dropdown-item" href="index.php?period=thisyear">Cette année</a></li>
             </ul>
           </div>
          </div>
        </div>

        <div class="row  mx-5 my-2  ">
          <div class="col-md-4  col-sm-12 my-2 ">
            <div id="carton" class="card rounded left-green-card fadeIn" >
              <div class="icon-carton"></div>
              <h6 class="text-white my-2 mx-3">Total de commande effectué</h6>
              <h2 class="text-center text-white pt-5"> 
                <?php 
                  $countorder = getCountOrder($period);
                  echo $countorder;
                ?> commandes
                  
              </h2>
            </div>
          </div>
          

          <div class="col-md-4  col-sm-12 my-2">
            <div id="camion" class="card rounded left-orange-card fadeIn  " >
              <h6 class="text-white my-2 mx-3">Livre expédié pour vous</h6>
              <h2 class="text-center text-white pt-5">
                <?php
                  $totalbooks=getTotalBooksAllOrder($period);
                  echo $totalbooks;
                ?> livres   
              </h2>
              <div class=" icon-camion">
              </div>
            </div>
          </div>
         

          <div class="col-md-4  col-sm-12 my-2 ">
            <div id='commande'class="card rounded left-green-card fadeIn" >
              <h6 class="text-white my-2 mx-3">Nombre de livre par commande</h6>
              <h2 class="text-center text-white pt-5">
               <?php 
               if($totalbooks==0 &&  $countorder==0)
               {
                echo 0;
               }
               else
               {
               $bookperorder=$totalbooks/$countorder;
               echo number_format($bookperorder,2);
               }

               ?> livre/commande
               </h2>
            </div>
          </div>
          </div>
       

        <div class="row  mx-5 my-2 ">
          <div class="col-md-4  col-sm-12 my-2">
            <div id="poids" class="card rounded right-orange-card fadeIn ">
              <h6 class="text-white my-2 mx-3">Poids total de vos livres expédié</h6> 
              <h2 class="text-center text-white pt-5">
                <?php
                echo getTotalWeightBooks($period); 
                ?> kg
              </h2>
              <div class="icon-poids"> 
              </div>
            </div>
          </div>
          
          
          <div class="col-md-4  col-sm-12 my-2">
            <div  id="livre" class="card rounded middle-orange-card fadeIn">
              <h6 class="text-white my-2 mx-3">Hauteur de vos livres expédié</h6>
              <h2 class="text-center text-white pt-5">
                <?php 
                echo getTotalHeightBooks($period); 
                ?> m 
                </h2>
              <div class="icon-livre">
              </div>
            </div>
          </div>

          <div class="col-md-4  col-sm-12 my-2">
            <div id="arbre" class="card rounded right-purple-card fadeIn">
              <h6 class="text-white my-2 mx-3">Nombre d'arbres utilisé pour vos livres</h6>
              <h2 class="text-center text-white pt-5">
                <?php
                echo HowManyTree4OneBook($period);
                ?> arbres   
              </h2>
              <div class="icon-arbre">
              </div>
            </div>
          </div>
        </div>

         <div class="row  mx-5 my-2">

          <div class="col-md-4  col-sm-12 my-2">
            <div id="genre" class="card rounded mid-green-card fadeIn" >
               <div class="icon-genre">
              </div>
              <h6 class="text-white my-2 mx-3">Répartition des lecteurs par genre </h6>
              <h2 class="text-center text-white pt-4">
                <?php 

                  $results = getGenderByName($period);

                  echo $results["women"] . " femmes<br/>" . $results["men"] . " hommes";
                ?>
                
              </h2>
            </div>
          </div>

          <div class="col-md-4  col-sm-12 my-2">
            <div id="ville" class="card rounded mid-green-card fadeIn" >
               <div class="icon-ville">
              </div>
              <h6 class="text-white my-2 mx-3">TOP 3 des ville avec le plus de commande </h6>
              <h2 class="text-center text-white pt-1">
                 <?php 
                  $results=top3region($period);
                  if ($results==false)
                  {
                    echo "<br>il n'y a pas de top 3";
                  }
                  else
                  {
                    $i=0;
                    foreach ($results as $key => $value)
                    {
                      if ($i == 0)
                        echo "<div style= \"font-size:110%\">" . $key . " : " . $value . "<br></div>";

                      if ($i==1)
                       echo "<div style= \"font-size:100%\">" . $key . " : " . $value . "<br></div>";

                      if ($i==2)
                        echo "<div style= \"font-size:90%\">" . $key . " : " . $value . "<br></div>";
                     

                      $i++;
                    }

                  }
                  ?>
              </h2>
            </div>
          </div>

          <div class="col-md-4  col-sm-12 my-2">
            <div id="user" class="card rounded right-green-card fadeIn ">
              <div class="icon-user">
              </div>
              <h6 class="text-white my-2 mx-3">TOP 3 des prénoms les plus courants</h6>
              <h2 class="text-center text-white pt-1">
                <?php 
                   $results=top3name($period);
                   if ($results==false)
                    {
                      echo "<br>il n'y a pas de top 3";
                    }
                   else
                    {
                     $i=0;
                    foreach ($results as $key => $value) 
                      {
                      if ($i == 0)
                        echo "<div style= \"font-size:110%\">" . $key. " : " . $value . "<br></div>";

                      if ($i==1)
                       echo "<div style= \"font-size:100%\">" . $key. " : " . $value . "<br></div>";

                      if ($i==2)
                        echo "<div style= \"font-size:90%\">" . $key . " : " . $value . "<br></div>";

                      $i++;
                      }
                    } 
                 ?>
            </h2>
            </div>
          </div>
        </div>
          <div class="row  mx-5 my-2">
             <div class="col-md-4  col-sm-12 my-2">
              <div id="terre" class="card rounded mid-green-card fadeIn" >
               <div class="icon-terre">
              </div>
              <h6 class="text-white my-2 mx-3">Expédition la plus lointaine </h6>
              <h2 class="text-center text-white pt-5">
                <?php
                $results=getTheFurthestCountry($period);
                if($results==false)
                {
                  echo "erreur";
                }
                else
                {
                echo $results["country"]."<br>".round(intval($results["distance"])/1000)." "."km";
                }
                

                 
                ?>
                
              </h2>
             </div>
            </div>
          </div>
    

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous">
      </script>
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

      <script type="text/javascript">
        

          
          $('#colorpicker-red').click(function(){
            $('.card').css('background','#d63031');
            $('.btn').css('color','#d63031');
            $('.btn').css('border-color','#d63031');



          })
          $('#colorpicker-blue').click(function(){
            $('.card').css('background','#0984e3');
            $('.btn').css('color','#0984e3');
            $('.btn').css('border-color','#0984e3');

          });
            $('#colorpicker-green').click(function(){
            $('.card').css('background','#00b894');
            $('.btn').css('color','#00b894');
            $('.btn').css('border-color','#00b894');

          });
            $('#ville').click(function(){
            $('.icon-ville').fadeIn();

          });
         
              $('#arbre').mouseenter(function(){
              $('.icon-arbre').fadeIn();
              $('#arbre').css("transform", 'scale(1.1)')
            });

             $('#arbre').mouseleave(function(){
             $('.icon-arbre').fadeOut();
              $('#arbre').css("transform", 'scale(1.0)')
            });

           $('#user').mouseenter(function(){
              $('.icon-user').fadeIn();
            });

             $('#user').mouseleave(function(){
             $('.icon-user').fadeOut();
            });
  ;    
          
          
             $('#terre').mouseenter(function(){
              $('.icon-terre').fadeIn();
              $('#terre').css("transform", 'scale(1.1)') 
            });

             $('#terre').mouseleave(function(){
             $('.icon-terre').fadeOut();
             $('#terre').css("transform", 'scale(1.0)')
            });

             $('#livre').mouseenter(function(){
              $('.icon-livre').fadeIn();
               $('#livre').css("transform", 'scale(1.1)') 
            });

             $('#livre').mouseleave(function(){
             $('.icon-livre').fadeOut();
             $('#livre').css("transform", 'scale(1.0)')
            });

           $('#poids').mouseenter(function(){
              $('.icon-poids').fadeIn();
              $('#poids').css("transform", 'scale(1.1)')  
            });

             $('#poids').mouseleave(function(){
             $('.icon-poids').fadeOut();
             $('#poids').css("transform", 'scale(1.0)')
            });

          $('#camion').mouseenter(function(){
              $('.icon-camion').fadeIn();
               $('#camion').css("transform", 'scale(1.1)')
            });

             $('#camion').mouseleave(function(){
             $('.icon-camion').fadeOut();
             $('#camion').css("transform", 'scale(1.0)')
            });

            
            $('#carton').mouseenter(function(){
              $('.icon-carton').fadeIn();
               $('#carton').css("transform", 'scale(1.1)')
            });

             $('#carton').mouseleave(function(){
             $('.icon-carton').fadeOut();
             $('#carton').css("transform", 'scale(1.0)')
            });

         
            $('#genre').mouseenter(function(){
              $('.icon-genre').fadeIn();
              $('#genre').css("transform", 'scale(1.1)')
            });

             $('#genre').mouseleave(function(){
             $('.icon-genre').fadeOut();
              $('#genre').css("transform", 'scale(1.0)')
            });

              $('#ville').mouseenter(function(){
              $('.icon-ville').fadeIn();
              $('#ville').css("transform", 'scale(1.1)')
            });

             $('#ville').mouseleave(function(){
             $('.icon-ville').fadeOut();
              $('#ville').css("transform", 'scale(1.0)')
            });
                $('#user').mouseenter(function(){
              $('.icon-user').fadeIn();
              $('#user').css("transform", 'scale(1.1)')
            });

             $('#user').mouseleave(function(){
             $('.icon-user').fadeOut();
              $('#user').css("transform", 'scale(1.0)')
            });
                $('#commande').mouseenter(function(){
              $('#commande').css("transform", 'scale(1.1)')
            });

             $('#commande').mouseleave(function(){
              $('#commande').css("transform", 'scale(1.0)')
            });





            ;


      </script>


    </body>
  </html>